# 📊 Reports & Analytics System - Complete Guide

## Overview
Comprehensive role-based reporting system with **17 different report types** across Financial, Operational, Performance, and Compliance categories.

---

## 🎯 Key Features

### ✅ **Role-Based Reports**
Each user role sees only relevant reports:
- **Load Owners**: 4 reports
- **Lenders**: 4 reports
- **Transporters**: 3 reports
- **Admins**: 4 reports
- **Common**: 2 reports (available to all)

### ✅ **4 Report Categories**
1. **Financial** 💰 - Money, returns, costs
2. **Operational** 📦 - Trips, deliveries, platform activity
3. **Performance** 📈 - KPIs, metrics, benchmarks
4. **Compliance** 🛡️ - KYC, tax, regulatory

### ✅ **Report Periods**
- Daily
- Weekly
- Monthly (default)
- Quarterly
- Yearly
- Custom date range

### ✅ **Export Formats** (Placeholder for future)
- PDF
- Excel
- CSV

---

## 📋 Available Reports by Role

### 🏢 **Load Owner Reports** (Borrower)

#### 1. Trip Summary Report 📦
**Category**: Operational

**Purpose**: Overview of all trips, funding status, completion rates

**Key Metrics**:
- Total Trips
- Funded Trips
- Completed Trips
- Pending Trips
- Total Funding Received

**Sample Data Shows**:
- 45 total trips
- 38 funded (84%)
- 32 completed (71%)
- 6 in progress
- 7 pending funding
- ₹67,50,000 total funding

**Charts**:
- Bar chart: Trips by Month
- Pie chart: Trip Status Distribution

---

#### 2. Funding Analysis 💰
**Category**: Financial

**Purpose**: Detailed analysis of funding sources, interest rates, payment terms

**Key Metrics**:
- Total Borrowed
- Average Interest Rate
- Total Interest Paid
- Active Loans
- Repayment Schedule

**Sample Data Shows**:
- ₹57,00,000 total borrowed
- 12.5% average interest rate
- ₹2,85,000 interest paid
- 12 active loans
- 26 repaid loans

**Charts**:
- Line chart: Funding Trend
- Bar chart: Interest Rate Distribution

---

#### 3. Cost Breakdown 📊
**Category**: Financial

**Purpose**: Breakdown of trip costs, fuel, tolls, and expenses

**Key Metrics**:
- Fuel Costs (40%)
- Toll Charges (20%)
- Labor Costs (24%)
- Financing Costs (12.7%)
- Other Expenses (3.3%)

**Sample Data Shows**:
- Total costs: ₹22,50,000
- Fuel: ₹9,00,000
- Labor: ₹5,40,000
- Tolls: ₹4,50,000

**Charts**:
- Pie chart: Cost Distribution

---

#### 4. Trip Performance Metrics 📈
**Category**: Performance

**Purpose**: Performance indicators including on-time delivery and profitability

**Key Metrics**:
- On-Time Delivery Rate
- Average Trip Duration
- Profit Margin
- Customer Satisfaction
- Repeat Customers

**Sample Data Shows**:
- 89% on-time delivery
- 2.3 days average duration
- 18.5% profit margin
- 4.6/5 customer rating
- 72% repeat customers

**Charts**:
- Line chart: Performance Trend

---

### 💼 **Lender Reports**

#### 1. Investment Portfolio Summary 💼
**Category**: Financial

**Purpose**: Complete overview of investment portfolio and allocation

**Key Metrics**:
- Total Invested
- Active Investments
- Completed Investments
- Portfolio Value
- Expected Returns

**Sample Data Shows**:
- ₹42,00,000 total invested
- 15 active investments
- 13 completed
- ₹45,30,000 portfolio value (+7.8%)
- ₹5,25,000 expected returns

**Charts**:
- Pie chart: Portfolio Allocation (Active vs Completed)
- Bar chart: Monthly Investment Volume

---

#### 2. Returns Analysis 📈
**Category**: Financial

**Purpose**: Detailed analysis of returns, ROI, and income

**Key Metrics**:
- Total Returns
- Average ROI
- Interest Income
- Principal Recovered
- Annualized Return

**Sample Data Shows**:
- ₹2,31,500 total returns
- 12.8% average ROI
- 15.6% annualized return
- ₹19,32,000 principal recovered
- 13 completed investments

**Charts**:
- Line chart: Cumulative Returns

---

#### 3. Risk Assessment Report 🛡️
**Category**: Compliance

**Purpose**: Risk analysis by borrower, trip type, and region

**Key Metrics**:
- Risk Distribution
- Default Rate (0%)
- Concentration Risk
- Credit Quality
- Diversification Score (8.5/10)

**Sample Data Shows**:
- 60% Low Risk investments
- 35% Medium Risk
- 5% High Risk
- Well diversified portfolio

**Charts**:
- Pie chart: Risk Distribution

---

#### 4. Investment Performance 📊
**Category**: Performance

**Purpose**: Track performance metrics vs benchmarks

**Key Metrics**:
- YTD Returns
- Monthly Performance
- Best Performers
- Benchmark Comparison
- Sharpe Ratio

**Sample Data Shows**:
- 15.6% YTD returns
- Outperforming benchmark by 3.6%
- 92% hit rate
- Lower volatility than market

**Charts**:
- Line chart: Performance vs Benchmark

---

### 🚛 **Transporter Reports**

#### 1. Delivery Summary 📦
**Category**: Operational

**Key Metrics**:
- Total Deliveries
- On-Time Deliveries
- Delayed Deliveries
- Distance Covered
- Fuel Efficiency

**Sample Data**: 52 deliveries, 46 on-time, 72,800 km covered

---

#### 2. Earnings Report 💰
**Category**: Financial

**Key Metrics**:
- Total Earnings
- Average Per Trip
- Bonus Earned
- Deductions
- Net Income

**Sample Data**: ₹7,80,000 earnings, ₹15,000 per trip average

---

#### 3. Performance Metrics ⭐
**Category**: Performance

**Key Metrics**:
- Overall Rating
- Delivery Success Rate
- Customer Reviews
- Efficiency Score
- Safety Record

**Sample Data**: 4.7/5 rating, 96% success rate

---

### 👨‍💼 **Admin Reports**

#### 1. Platform Overview 🎯
**Category**: Operational

**Key Metrics**:
- Total Users
- Active Trips
- Total GMV
- Platform Revenue
- Growth Metrics

**Sample Data**: 485 users, ₹1,57,50,000 GMV, +25% growth

---

#### 2. User Analytics 👥
**Category**: Operational

**Key Metrics**:
- New Users
- Active Users
- User Retention
- Churn Rate
- Engagement Score

**Sample Data**: 87 new users, 78% retention, 8.5/10 engagement

---

#### 3. Transaction Summary 💳
**Category**: Financial

**Key Metrics**:
- Total Transactions
- Transaction Volume
- Average Transaction Size
- Payment Methods
- Success Rate

**Sample Data**: 1,247 transactions, ₹1,85,00,000 volume, 98.5% success

---

#### 4. KYC Status Report ✅
**Category**: Compliance

**Key Metrics**:
- Pending KYC
- Approved KYC
- Rejected KYC
- Verification Time
- Approval Rate

**Sample Data**: 412 approved, 47 pending, 94% approval rate

---

### 🌐 **Common Reports** (All Roles)

#### 1. Wallet Statement 💳
**Category**: Financial

**Key Metrics**:
- Opening Balance
- Credits
- Debits
- Closing Balance
- Transaction History

**Sample Data**: ₹2,50,000 opening, ₹4,80,000 closing

---

#### 2. Tax Summary 🧾
**Category**: Compliance

**Key Metrics**:
- Taxable Income
- TDS Deducted
- GST Collected
- Tax Liability
- Form 26AS Data

**Sample Data**: ₹2,85,000 taxable income, ₹28,500 TDS, quarterly breakup

---

## 🎨 User Interface

### Report Cards
Each report card displays:
- **Icon** - Visual identifier
- **Title** - Report name
- **Category Badge** - Colored by category
- **Description** - What the report shows
- **Key Metrics Preview** - Top 3 metrics
- **Generate Button** - Click to create report

### Category Colors:
- 🟢 **Financial** - Green
- 🔵 **Operational** - Blue
- 🟣 **Performance** - Purple
- 🟠 **Compliance** - Orange

### Filters:
- **Period Selector** - Daily/Weekly/Monthly/Quarterly/Yearly
- **Category Tabs** - Filter by report category
- **"All Reports"** tab shows everything

### Generated Report Display:
1. **Header Section**
   - Report title
   - Generation timestamp
   - Period covered
   - Export buttons (PDF/Excel)

2. **Summary Cards**
   - Key metrics in grid
   - Large numbers with trend indicators
   - ↑/↓ Change percentages

3. **Details Table**
   - Sortable columns
   - Formatted currency values
   - All transaction/trip details

4. **Visual Analytics**
   - Chart placeholders
   - Chart type indicators
   - Ready for chart library integration

---

## 📂 File Structure

### Created Files:

1. **Types**:
   - `src/types/reports.ts` - TypeScript interfaces

2. **Configuration**:
   - `src/config/reportConfigs.ts` - All 17 report definitions

3. **Services**:
   - `src/services/reportService.ts` - Report generation logic with sample data

4. **Pages**:
   - `src/pages/Reports.tsx` - Main reports page UI

5. **Routes**:
   - Updated `src/App.tsx` - Added `/reports` route

6. **Navigation**:
   - Updated `src/components/DashboardLayout.tsx` - Added Reports menu item

---

## 🚀 How to Access

### For Users:
1. **Login** to your account
2. **Click your avatar** (top-right)
3. Select **"Reports"** from dropdown
4. **Or** navigate to: `http://localhost:8081/reports`

### Report Generation:
1. Select **Period** (daily/weekly/monthly/etc.)
2. Choose **Category** tab or view all
3. Click **"Generate Report"** on any report card
4. View **detailed report** below
5. **Export** as PDF or Excel (placeholder)

---

## 💻 Developer Guide

### Adding a New Report Type

#### Step 1: Add Type
```typescript
// src/types/reports.ts
export type ReportType =
  | 'trip_summary'
  | 'your_new_report'; // Add here
```

#### Step 2: Configure Report
```typescript
// src/config/reportConfigs.ts
export const reportConfigs = {
  your_new_report: {
    type: 'your_new_report',
    title: 'Your New Report',
    description: 'What this report shows',
    roles: ['load_owner', 'admin'],
    icon: 'Package', // Lucide icon name
    category: 'financial', // or operational/performance/compliance
    dataPoints: [
      'Metric 1',
      'Metric 2',
      'Metric 3'
    ],
  },
};
```

#### Step 3: Generate Sample Data
```typescript
// src/services/reportService.ts
generateYourNewReport(filter: ReportFilter): ReportData {
  return {
    id: `report_${Date.now()}`,
    type: 'your_new_report',
    title: 'Your New Report',
    generatedAt: new Date().toISOString(),
    period: filter.period,
    startDate: filter.startDate || ...,
    endDate: filter.endDate || ...,
    summary: {
      totalCount: 100,
      totalAmount: 1000000,
      averageAmount: 10000,
      trends: [
        { label: 'Metric 1', value: '100', change: 10 },
        { label: 'Metric 2', value: '₹10,000' },
        // ... more trends
      ],
    },
    details: [
      { col1: 'value1', col2: 'value2', ... },
      // ... more rows
    ],
    charts: [
      {
        type: 'bar',
        title: 'Chart Title',
        data: {
          labels: ['Jan', 'Feb', 'Mar'],
          datasets: [{
            label: 'Dataset',
            data: [100, 200, 300],
            backgroundColor: '#10b981',
          }],
        },
      },
    ],
  };
}
```

#### Step 4: Register Generator
```typescript
// In generateReport() method
const reportGenerators = {
  // ... existing generators
  your_new_report: () => this.generateYourNewReport(filter),
};
```

---

## 📊 Integrating Real Data

Currently uses **sample data**. To use real data:

### Option 1: Fetch from API
```typescript
async generateTripSummary(filter: ReportFilter): Promise<ReportData> {
  const response = await fetch('/api/reports/trip-summary', {
    method: 'POST',
    body: JSON.stringify(filter),
  });
  const data = await response.json();
  return data;
}
```

### Option 2: Query Database Directly
```typescript
import { db } from '@/db/database';

generateTripSummary(filter: ReportFilter): ReportData {
  const trips = db.prepare(`
    SELECT * FROM trips
    WHERE created_at BETWEEN ? AND ?
  `).all(filter.startDate, filter.endDate);

  // Process trips data
  return {
    summary: {
      totalCount: trips.length,
      // ... calculate from trips
    },
    details: trips,
    // ...
  };
}
```

---

## 📈 Adding Charts (Future Enhancement)

### Install Chart Library:
```bash
npm install recharts
# or
npm install chart.js react-chartjs-2
```

### Replace Chart Placeholder:
```tsx
import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip } from 'recharts';

// In Reports.tsx, replace the chart placeholder with:
<LineChart width={500} height={300} data={chart.data.datasets[0].data.map((val, idx) => ({
  name: chart.data.labels[idx],
  value: val
}))}>
  <CartesianGrid strokeDasharray="3 3" />
  <XAxis dataKey="name" />
  <YAxis />
  <Tooltip />
  <Line type="monotone" dataKey="value" stroke="#8884d8" />
</LineChart>
```

---

## 🔄 PDF/Excel Export (Future Enhancement)

### PDF Export:
```bash
npm install jspdf jspdf-autotable
```

```typescript
import jsPDF from 'jspdf';
import autoTable from 'jspdf-autotable';

const exportPDF = (report: ReportData) => {
  const doc = new jsPDF();
  doc.text(report.title, 14, 20);

  autoTable(doc, {
    head: [Object.keys(report.details[0])],
    body: report.details.map(d => Object.values(d)),
  });

  doc.save(`${report.type}_${Date.now()}.pdf`);
};
```

### Excel Export:
```bash
npm install xlsx
```

```typescript
import * as XLSX from 'xlsx';

const exportExcel = (report: ReportData) => {
  const ws = XLSX.utils.json_to_sheet(report.details);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'Report');
  XLSX.writeFile(wb, `${report.type}_${Date.now()}.xlsx`);
};
```

---

## 🎯 Use Cases

### For Load Owners:
1. **Track trip efficiency** - Trip Summary
2. **Analyze funding costs** - Funding Analysis
3. **Optimize expenses** - Cost Breakdown
4. **Improve performance** - Trip Performance

### For Lenders:
1. **Monitor portfolio health** - Portfolio Summary
2. **Track returns** - Returns Analysis
3. **Assess risk exposure** - Risk Assessment
4. **Benchmark performance** - Investment Performance

### For Admins:
1. **Platform health monitoring** - Platform Overview
2. **User growth tracking** - User Analytics
3. **Financial oversight** - Transaction Summary
4. **Compliance monitoring** - KYC Status

### For All:
1. **Financial records** - Wallet Statement
2. **Tax preparation** - Tax Summary

---

## ✅ Testing Checklist

- [ ] Navigate to Reports page
- [ ] See only reports for your role
- [ ] Filter by category tabs
- [ ] Change report period
- [ ] Generate each report type
- [ ] View summary cards
- [ ] Check details table
- [ ] See chart placeholders
- [ ] Try PDF export button (placeholder)
- [ ] Try Excel export button (placeholder)
- [ ] Test with different roles
- [ ] Verify sample data accuracy

---

## 🚀 Future Enhancements

1. **Scheduled Reports** - Auto-generate and email
2. **Custom Date Ranges** - Exact date picker
3. **Saved Reports** - Bookmark favorite configs
4. **Report Sharing** - Share link with team
5. **Report Comparison** - Compare periods side-by-side
6. **Real-time Data** - Auto-refresh dashboards
7. **Advanced Filters** - More granular filtering
8. **Data Export** - Multiple formats
9. **Charts Integration** - Live visualizations
10. **Report Templates** - Customizable layouts

---

## 📞 Quick Reference

| Role | Reports Available | Categories |
|------|------------------|------------|
| Load Owner | 6 (4 role-specific + 2 common) | All categories |
| Lender | 6 (4 role-specific + 2 common) | All categories |
| Transporter | 5 (3 role-specific + 2 common) | Operational, Financial, Performance |
| Admin | 6 (4 role-specific + 2 common) | All categories |

**Total**: 17 unique report types
**Access**: Avatar menu → Reports
**URL**: `/reports`

---

**🎉 Reports system is fully functional and ready to use!**
